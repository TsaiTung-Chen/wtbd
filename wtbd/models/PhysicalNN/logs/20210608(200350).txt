subset_id_path: ./subset_id/2015~2020-07-03.json
datasetDirs: ['./dataset/2015~2016/detect/', './dataset/2017-08-02/detect/', './dataset/2017-10-25/detect/', './dataset/2020-06-03/detect/', './dataset/2020-07-03/detect/']
walk: False
cutin_freq: 4000
spect_shape: (96, 96)
modelname: PhysicalNN
modelfolder_path: ./{PhysicalNN}/
PhysicalCNN_path: 
loglevel: INFO
logpath: ./{PhysicalNN}/logs/*.txt

DTYPE: float32
DATA_FORMAT: channels_last
BATCH_SIZE: 128
EPOCHS: 1000

1 Physical GPUs, 1 Logical GPUs

[train]
number of classes: 2
number of data: 4031
number of data in each class: {0 = 1252, 1 = 2779}
ratios of classes: {0 = 0.3106, 1 = 0.6894}
class_weight: {0 = 1.6098, 1 = 0.7253}

[valid]
number of classes: 2
number of data: 1330
number of data in each class: {0 = 555, 1 = 775}
ratios of classes: {0 = 0.4173, 1 = 0.5827}
class_weight: {0 = 1.1982, 1 = 0.8581}

[test]
number of classes: 2
number of data: 1663
number of data in each class: {0 = 469, 1 = 1194}
ratios of classes: {0 = 0.2820, 1 = 0.7180}
class_weight: {0 = 1.7729, 1 = 0.6964}


Training----------------
>> build model... 
Model: "physicalnn"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_sp (InputLayer)           [(None, 96, 96)]     0                                            
__________________________________________________________________________________________________
insert_channel_axis (InsertChan (None, 96, 96, 1)    0           input_sp[0][0]                   
__________________________________________________________________________________________________
split (Split_)                  [(None, 96, 32, 1),  0           insert_channel_axis[0][0]        
__________________________________________________________________________________________________
input_rs (InputLayer)           [(None,)]            0                                            
__________________________________________________________________________________________________
classifier3b (Functional)       [(None,), (None,), ( 194         split[0][0]                      
                                                                 split[0][1]                      
                                                                 split[0][2]                      
                                                                 input_rs[0][0]                   
__________________________________________________________________________________________________
any_of_3 (AnyOf3_)              (None,)              0           classifier3b[0][0]               
                                                                 classifier3b[0][1]               
                                                                 classifier3b[0][2]               
==================================================================================================
Total params: 194
Trainable params: 194
Non-trainable params: 0
__________________________________________________________________________________________________
╒════╤════════════════════════════════════════════╤═════════════╤═══════════╤══════════════╕
│    │ name                                       │ trainable   │   n_train │ n_nontrain   │
╞════╪════════════════════════════════════════════╪═════════════╪═══════════╪══════════════╡
│  0 │ physicalnn (Functional)                    │ True        │       194 │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  1 │ ― input_sp (InputLayer)                    │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  1 │ ― insert_channel_axis (InsertChannelAxis_) │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  1 │ ― split (Split_)                           │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  1 │ ― input_rs (InputLayer)                    │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  1 │ ― classifier3b (Functional)                │ True        │       194 │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― classifier3b/bm1 (InputLayer)          │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― classifier3b/rs (InputLayer)           │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― classifier3b/bm2 (InputLayer)          │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― classifier3b/bm3 (InputLayer)          │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― spectrum (Spectrum_)                   │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― shift_sns (ShiftSNS_)                  │ True        │        96 │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― recorder_bs (Recorder_)                │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― recorder_sns (Recorder_)               │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― subtract (Subtract)                    │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― relu_residual (ReLU_)                  │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― recorder_residual (Recorder_)          │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― weighted_sum (WeightedSum_)            │ True        │        96 │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― recorder_avg_residual (Recorder_)      │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― s_function (SFunction_)                │ True        │         2 │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  2 │ ――― recorder_probability (Recorder_)       │ True        │           │              │
├────┼────────────────────────────────────────────┼─────────────┼───────────┼──────────────┤
│  1 │ ― any_of_3 (AnyOf3_)                       │ True        │           │              │
╘════╧════════════════════════════════════════════╧═════════════╧═══════════╧══════════════╛
done
>> fit...
done

history saved!
plot saved!


Testing------
loss: 0.4001 - accuracy: 0.8376 - recall: 0.9883 - precision: 0.8217 - f1_score: 0.8973

2021-06-08_20:06:41 [Shutdown loggers]
